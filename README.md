# Diamond from Diamondoid
Monte Carlo simulation for comparing diamond crystal formation efficiency using different diamondoid molecules, including: adamantane C$_{10}$H$_{16}$, diamantane C$_{14}$H$_{20}$, triamantane C$_{18}$H$_{24}$, tetramantane C$_{18}$H$_{24}$, pentamantane-1(2,3)4 C$_{26}$H$_{32}$, and pentamantane-1212 C$_{26}$H$_{32}$.

## Install, Build and Run
Clone this repository. "make all" will compile a program called "diamondMC" in the build directory. The Makefile assumes you are using g++ compiler with c++20 supports. There is no other dependency for this code. You can modify the Makefile if you want to use a different compiler.

To run the program, you can type "./diamondMC input.txt" in the build directory. An example input file is provided: "inputExample.txt". You can modify this input file to control how you want to run the Monte Carlo simulation. It allows you to modify the diamondoid molecule species, number of molecules, temperature, pressure and number of Monte Carlo steps, etc.

## Method
We use a Monte Carlo simulation to search the optimal structures formed by different diamondoid molecules, with the constraints that the internal carbon-carbon bonds of diamondoid molecules will remain intact, and the carbon-carbon bonds formed between two molecules have the same bond angle and bond length as that within the diamond lattice. Here we take another assumption that the carbon-hydrogen bonds are easier to be destroyed than the carbon-carbon bonds, so that dehydrogenation occurs first during the formation of diamond from diamondoid molecules. Such an assumption has shown to be reasonable for the formation of diamond using adamantane molecules. Therefore, in this study we only consider the carbon atoms and the carbon-carbon bond formation in our Monte Carlo simulations. We consider a simple Gibbs free energy $G = N_bE_b + PV - TS$, where $N_b$ is the number of carbon-carbon bonds formed between diamondoid molecules and $E_b$ is the carbon-carbon bond formation energy. We define the volume as that of the minimal box that contains all the diamondoid molecules. We then use Monte Carlo simulations to search for the optimal structures to minimize the Gibbs free energy. 

The simulation is performed in a $L \times L \times L$ closed box. We start the simulation by randomly putting $M$ molecules in the box. To accelerate the simulation, the $i$-th molecule is initialized to form at least one bond with previous molecules randomly, so that after initialization the $M$ molecules form a connected structure.
In each Monte Carlo step, we randomly pick one diamondoid molecule, and let it randomly form bonds with the remaining carbon atoms.
We calculate the enthalpy difference $\Delta H = E_b \Delta N_b + P \Delta V$ before and after each step. The probability that we accept the movement is $\mathrm{exp}(-\beta\Delta H)$, with $\beta = 1/{k_BT}$. We warm up the simulation at high initial temperature $T_i$ to further perturb the initial structure. Then gradually decrease the temperature to a final low temperature $T_f$, where we perform enough Monte Carlo updates until the structure is well converged. 